import{writeFile,mkdirSync}from'fs';import gulp from'gulp';import del from'del';import sequence from'run-sequence';import{rollup}from'rollup';import nodeResolve from'rollup-plugin-node-resolve';import commonjs from'rollup-plugin-commonjs';import babelRollup from'rollup-plugin-babel';import{Bundler}from'polymer-bundler';import{serialize}from'parse5';import pify from'pify';gulp.task('default',['dist']),gulp.task('clean',function(){return del(['lib','dist'])}),gulp.task('build',function(a){return sequence(['clean'],['build:lib','build:copy'],a)}),gulp.task('build:lib',function(){return rollup({entry:'src/index.js',plugins:[nodeResolve({jsnext:!0,main:!0}),commonjs({include:'node_modules/**'}),babelRollup({babelrc:!1,presets:[['env',{targets:{browsers:['last 2 versions','not ie 10']},modules:!1,exclude:['transform-es2015-classes']}]],plugins:['transform-object-assign']})]}).then(function(a){return a.write({format:'iife',moduleName:'PolymerRedux',dest:'lib/index.js'})})}),gulp.task('build:copy',function(){return gulp.src(['src/**.html']).pipe(gulp.dest('lib'))}),gulp.task('dist',['build'],function(){var a='lib/index.html',c=new Bundler({inlineScripts:!0});return c.generateManifest([a]).then(function(d){return c.bundle(d)}).then(function(d){var e=d.documents.get(a),f=e.ast,g=serialize(f);return mkdirSync('dist'),pify(writeFile)('dist/polymer-redux.html',g+'\n')})}),gulp.task('develop',['dist'],function(){gulp.watch(['src/**/*'],['dist'])});